# –û—Ç—á–µ—Ç –æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ Riverpod –¥–ª—è CredentialsStore

## –ß—Ç–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ (`CredentialsStoreState`)
- **–§–∞–π–ª**: `lib/credentials_store/providers/credentials_store_state.dart`
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å —Å–æ—Å—Ç–æ—è–Ω–∏—è (–±–µ–∑ Freezed) —Å –ø–æ–ª—è–º–∏:
  - `isInitialized` - —Å—Ç–∞—Ç—É—Å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–∞
  - `isDatabaseOpen` - —Å—Ç–∞—Ç—É—Å –æ—Ç–∫—Ä—ã—Ç–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
  - `isLoading` - –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
  - `databases` - —Å–ø–∏—Å–æ–∫ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
  - `currentDatabasePassword` - —Ç–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å –ë–î
  - `errorMessage` - —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
  - `lastActivity` - –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
  - `status` - —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î

### 2. –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä (`CredentialsStoreNotifier`)
- **–§–∞–π–ª**: `lib/credentials_store/providers/credentials_store_provider.dart`
- **–¢–∏–ø**: `StateNotifierProvider` (–∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π Riverpod)
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**:
  - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞
  - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ –ë–î
  - –ê–≤—Ç–æ–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ —Ç–∞–π–º–∞—É—Ç—É (15 –º–∏–Ω—É—Ç)
  - CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
  - –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π –æ—à–∏–±–æ–∫
  - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤

### 3. –ü—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã
–°–æ–∑–¥–∞–Ω—ã 11 —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ UI:

- `credentialsConnectionStatusProvider` - —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- `credentialsDatabasesProvider` - —Å–ø–∏—Å–æ–∫ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
- `credentialsDatabaseStatsProvider` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ë–î
- `credentialsIsLoadingProvider` - —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏
- `credentialsErrorMessageProvider` - —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- `credentialsTimeUntilAutoLockProvider` - –≤—Ä–µ–º—è –¥–æ –∞–≤—Ç–æ–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- `credentialsHasRecentActivityProvider` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- `credentialsIsInitializedProvider` - —Å—Ç–∞—Ç—É—Å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- `credentialsIsDatabaseOpenProvider` - —Å—Ç–∞—Ç—É—Å –æ—Ç–∫—Ä—ã—Ç–∏—è –ë–î

### 4. Enum —Å—Ç–∞—Ç—É—Å–æ–≤ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- `DatabaseConnectionStatus` —Å 5 —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏:
  - `disconnected` - –æ—Ç–∫–ª—é—á–µ–Ω–æ
  - `connecting` - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
  - `connected` - –ø–æ–¥–∫–ª—é—á–µ–Ω–æ
  - `locked` - –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ
  - `error` - –æ—à–∏–±–∫–∞
- –†–∞—Å—à–∏—Ä–µ–Ω–∏—è —Å –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ –∏ —É–¥–æ–±–Ω—ã–º–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏

### 5. –î–µ–º–æ-—Å—Ç—Ä–∞–Ω–∏—Ü–∞
- **–§–∞–π–ª**: `lib/credentials_store/demo/credentials_riverpod_demo_page.dart`
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**:
  - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
  - –ö–Ω–æ–ø–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π
  - –†–µ–∞–∫—Ç–∏–≤–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
  - –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ—à–∏–±–æ–∫
  - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ —Ç–∞–π–º–µ—Ä—ã –∞–≤—Ç–æ–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

### 6. –¢–µ—Å—Ç—ã
- **–§–∞–π–ª**: `test/credentials_store_provider_test.dart`
- **–ü–æ–∫—Ä—ã—Ç–∏–µ**:
  - 15 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
  - 4 —Ç–µ—Å—Ç–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
  - 2 —Ç–µ—Å—Ç–∞ enum —Å—Ç–∞—Ç—É—Å–æ–≤
  - 3 –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–∞
  - –ú–æ–∫–∏ –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤
  - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1. –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π Riverpod
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π `StateNotifierProvider` –≤–º–µ—Å—Ç–æ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π –∏–∑-–∑–∞ –ø—Ä–æ–±–ª–µ–º —Å `build_runner` –≤ –ø—Ä–æ–µ–∫—Ç–µ.

### 2. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø–æ—Ç–æ–∫–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∏ `_disposed` –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–æ—Å–ª–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- –ó–∞—â–∏—Ç–∞ –æ—Ç race conditions

### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π –æ—à–∏–±–æ–∫
- –û–±—Ä–∞–±–æ—Ç–∫–∞ `DatabaseError` —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∞–º–∏
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å–∏—Å—Ç–µ–º—É

### 4. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
- –¢–∞–π–º–µ—Ä –Ω–∞ 15 –º–∏–Ω—É—Ç –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ —Å–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### 5. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ—Å—á–µ—Ç—ã —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã

## –°—Ç–∞—Ç—É—Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

‚úÖ **–ó–∞–≤–µ—Ä—à–µ–Ω–æ:**
- –ü—Ä–æ–≤–∞–π–¥–µ—Ä —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –ü—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã
- –î–µ–º–æ-—Å—Ç—Ä–∞–Ω–∏—Ü–∞
- –ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –≠–∫—Å–ø–æ—Ä—Ç—ã –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

üîÑ **–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ —Ä–æ—É—Ç–∏–Ω–≥
- –†–µ–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ UI/UX
- –í–æ–∑–º–æ–∂–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ Riverpod

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```dart
// –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä
final state = ref.watch(credentialsStoreProvider);

// –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã
final isLoading = ref.watch(credentialsIsLoadingProvider);
final databases = ref.watch(credentialsDatabasesProvider);
final status = ref.watch(credentialsConnectionStatusProvider);

// –î–µ–π—Å—Ç–≤–∏—è
final notifier = ref.read(credentialsStoreProvider.notifier);
await notifier.openDatabase(password);
await notifier.closeDatabase();
notifier.lockDatabase();
```

–ü—Ä–æ–≤–∞–π–¥–µ—Ä –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
