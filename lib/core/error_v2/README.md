# –°–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ v2 –¥–ª—è CodexaPass

–£–ª—É—á—à–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏ –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º –ø–æ–¥—Ö–æ–¥–æ–º –∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é –æ—à–∏–±–∫–∞–º–∏ –≤ Flutter –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö.

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è v2

### –ü–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –≤–µ—Ä—Å–∏–µ–π v1:

- **–ë–æ–ª–µ–µ —á–µ—Ç–∫–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è**: –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —Ç–∏–ø—ã –æ—à–∏–±–æ–∫ —Å –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥**: `Result<T>` –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π –±–µ–∑ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ**: –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –æ—à–∏–±–æ–∫
- **–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è**: –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ-–∑–∞–≤–∏—Å–∏–º—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —è–∑—ã–∫–æ–≤
- **–ì–∏–±–∫–∏–µ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**: –ú–Ω–æ–∂–µ—Å—Ç–≤–æ —Å–ø–æ—Å–æ–±–æ–≤ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—à–∏–±–æ–∫ (—Å–Ω—ç–∫–±–∞—Ä—ã, –¥–∏–∞–ª–æ–≥–∏, –±–∞–Ω–Ω–µ—Ä—ã, –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã)
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –º–µ—Ç—Ä–∏–∫ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –æ—à–∏–±–æ–∫
- **Async/await –ø–æ–¥–¥–µ—Ä–∂–∫–∞**: –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º–∏
- **Retry –º–µ—Ö–∞–Ω–∏–∑–º**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ —Å exponential backoff
- **–ú–µ—Ç—Ä–∏–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –æ—à–∏–±–æ–∫

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

```
error_v2/
‚îú‚îÄ‚îÄ error_base.dart           # –ë–∞–∑–æ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –∏ –∫–ª–∞—Å—Å—ã
‚îú‚îÄ‚îÄ error_types.dart          # –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–∏–ø—ã –æ—à–∏–±–æ–∫
‚îú‚îÄ‚îÄ result.dart               # –°–∏—Å—Ç–µ–º–∞ Result<T>
‚îú‚îÄ‚îÄ error_handler.dart        # –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫
‚îú‚îÄ‚îÄ error_localization.dart   # –°–∏—Å—Ç–µ–º–∞ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ error_ui.dart             # UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îú‚îÄ‚îÄ examples.dart             # –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ error_system_v2.dart      # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
‚îî‚îÄ‚îÄ README.md                 # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üéØ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```dart
import 'package:codexa_pass/core/error_v2/error_system_v2.dart';

// –°–æ–∑–¥–∞–Ω–∏–µ –æ—à–∏–±–∫–∏
final error = AuthenticationErrorV2(
  errorType: AuthenticationErrorType.invalidCredentials,
  message: '–ù–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ',
  username: 'user@example.com',
);

// –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—à–∏–±–∫–∏
await ErrorDisplayV2.show(context, error);
```

### 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Result<T>

```dart
// –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
final result = await ResultV2Utils.tryCallAsync(() async {
  return await fetchUserData(userId);
});

// –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
result.fold(
  (data) => print('–£—Å–ø–µ—Ö: $data'),
  (error) => print('–û—à–∏–±–∫–∞: ${error.localizedMessage}'),
);
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –æ—à–∏–±–æ–∫

```dart
// –°–æ–∑–¥–∞–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞
final errorHandler = ErrorHandlerV2(
  logger: MyErrorLogger(),
  analytics: MyErrorAnalytics(),
  notification: MyErrorNotification(),
);

// –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–∞–∫ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ
setGlobalErrorHandler(errorHandler);

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
final result = await errorHandler.executeWithRetry(() async {
  return await performNetworkOperation();
}, maxRetries: 3);
```

## üìã –ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ

### –¢–∏–ø—ã –æ—à–∏–±–æ–∫

–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ—à–∏–±–æ–∫:

#### üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (`AuthenticationErrorV2`)
```dart
final authError = AuthenticationErrorV2(
  errorType: AuthenticationErrorType.sessionExpired,
  message: '–°–µ—Å—Å–∏—è –∏—Å—Ç–µ–∫–ª–∞',
  username: 'user@example.com',
  attemptNumber: 1,
);
```

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã:**
- `invalidCredentials` - –Ω–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- `sessionExpired` - —Å–µ—Å—Å–∏—è –∏—Å—Ç–µ–∫–ª–∞  
- `biometricFailed` - –æ—à–∏–±–∫–∞ –±–∏–æ–º–µ—Ç—Ä–∏–∏
- `accountLocked` - –∞–∫–∫–∞—É–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
- –ò –¥—Ä—É–≥–∏–µ...

#### üîí –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ (`EncryptionErrorV2`)
```dart
final cryptoError = EncryptionErrorV2(
  errorType: EncryptionErrorType.decryptionFailed,
  message: '–û—à–∏–±–∫–∞ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏',
  algorithm: 'AES-256-GCM',
  keyId: 'key_12345',
);
```

#### üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (`DatabaseErrorV2`)
```dart
final dbError = DatabaseErrorV2(
  errorType: DatabaseErrorType.connectionFailed,
  message: '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ë–î',
  tableName: 'users',
  query: 'SELECT * FROM users WHERE id = ?',
);
```

#### üåê –°–µ—Ç—å (`NetworkErrorV2`)
```dart
final netError = NetworkErrorV2(
  errorType: NetworkErrorType.timeout,
  message: '–í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∏—Å—Ç–µ–∫–ª–æ',
  url: 'https://api.example.com/data',
  statusCode: 408,
);
```

#### ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è (`ValidationErrorV2`)
```dart
final validationError = ValidationErrorV2(
  errorType: ValidationErrorType.weakPassword,
  message: '–ü–∞—Ä–æ–ª—å —Å–ª–∏—à–∫–æ–º —Å–ª–∞–±—ã–π',
  field: 'password',
  value: '123456',
  constraints: {'minLength': 8},
);
```

### –°–∏—Å—Ç–µ–º–∞ Result<T>

`Result<T>` –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º:

#### –û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

```dart
// –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
final success = SuccessV2('–¥–∞–Ω–Ω—ã–µ');
final failure = FailureV2(error);

// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
if (result.isSuccess) {
  print('–£—Å–ø–µ—Ö: ${result.value}');
}

// –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
final transformed = result.map((data) => data.toUpperCase());

// –¶–µ–ø–æ—á–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–π
final chained = result.flatMap((data) => processData(data));

// –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏
final recovered = result.recover((error) => '–∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é');
```

#### –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

```dart
// –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
final asyncResult = await result.mapAsync((data) async {
  return await processAsync(data);
});

// –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞
final asyncChained = await result.flatMapAsync((data) async {
  return await fetchMoreData(data);
});

// –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
final asyncRecovered = await result.recoverAsync((error) async {
  return await getFromCache();
});
```

#### –£—Ç–∏–ª–∏—Ç—ã

```dart
// –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
final result = ResultV2Utils.tryCall(() {
  return riskyOperation();
});

// –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
final combined = ResultV2Utils.combine([result1, result2, result3]);

// –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
final parallel = await ResultV2Utils.parallel([
  future1,
  future2,
  future3,
]);
```

### –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫

`ErrorHandlerV2` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫:

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∞

```dart
final handler = ErrorHandlerV2(
  logger: CustomErrorLogger(),
  analytics: CustomErrorAnalytics(), 
  notification: CustomErrorNotification(),
  recoveryHandlers: [
    AuthRecoveryHandlerV2(),
    NetworkRecoveryHandlerV2(),
    CustomRecoveryHandler(),
  ],
);
```

#### –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π

```dart
// –ü—Ä–æ—Å—Ç–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
final result = await handler.executeWithErrorHandling(() async {
  return await fetchData();
});

// –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å –ø–æ–≤—Ç–æ—Ä–Ω—ã–º–∏ –ø–æ–ø—ã—Ç–∫–∞–º–∏
final retryResult = await handler.executeWithRetry(() async {
  return await unreliableOperation();
}, 
  maxRetries: 3,
  useExponentialBackoff: true,
);

// –†—É—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏
await handler.handleError(error,
  shouldAttemptRecovery: true,
  shouldNotifyUser: true,
);
```

#### –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è:

- `none` - –±–µ–∑ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- `retry` - –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞
- `retryWithBackoff` - –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
- `fallback` - –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º
- `reset` - —Å–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è
- `restart` - –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
- `safeMode` - –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä–µ–∂–∏–º
- `custom` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –ª–æ–≥–∏–∫–∞

### –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ª–æ–∫–∞–ª–∏–∑—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö:

```dart
// –ü–æ–ª—É—á–µ–Ω–∏–µ –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
final localizedMessage = error.localizedMessage;
final localizedTitle = error.localizedTitle;
final localizedSolution = error.localizedSolution;

// –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —è–∑—ã–∫–∞
getGlobalLocalizer().setLocale('en');

// –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —è–∑—ã–∫–∏
final supportedLocales = getGlobalLocalizer().supportedLocales; // ['ru', 'en']
```

### UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### –¢–∏–ø—ã –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

```dart
// –°–Ω—ç–∫–±–∞—Ä (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
await ErrorDisplayV2.show(context, error);

// –î–∏–∞–ª–æ–≥ –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
await ErrorDisplayV2.show(context, error,
  config: ErrorDisplayConfigV2.critical(),
);

// –ë–∞–Ω–Ω–µ—Ä –¥–ª—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π  
await ErrorDisplayV2.show(context, error,
  config: ErrorDisplayConfigV2.warning(),
);

// –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
await ErrorDisplayV2.show(context, error,
  config: const ErrorDisplayConfigV2(
    type: ErrorDisplayType.fullscreen,
  ),
);
```

#### –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤–∏–¥–∂–µ—Ç

```dart
Widget buildErrorSection() {
  return InlineErrorWidgetV2(
    error: error,
    config: const ErrorDisplayConfigV2(
      showSolution: true,
      showRetryButton: true,
    ),
    onRetry: () => performRetry(),
    onDismiss: () => hideError(),
  );
}
```

#### –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è

```dart
const config = ErrorDisplayConfigV2(
  type: ErrorDisplayType.dialog,
  duration: Duration(seconds: 10),
  showTechnicalDetails: true,
  showSolution: true,
  showRetryButton: true,
  showReportButton: true,
  customTitle: '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞',
  customIcon: Icon(Icons.warning, color: Colors.red),
  backgroundColor: Colors.red.shade100,
  customActions: [
    TextButton(
      onPressed: () => openHelp(),
      child: Text('–ü–æ–º–æ—â—å'),
    ),
  ],
);
```

## üîß –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

```dart
class CustomRecoveryHandler implements RecoveryHandlerV2 {
  @override
  bool canHandle(AppErrorV2 error) {
    return error is DatabaseErrorV2 && 
           error.errorType == DatabaseErrorType.corruptedDatabase;
  }
  
  @override
  Future<ResultV2<bool>> tryRecover(AppErrorV2 error) async {
    // –õ–æ–≥–∏–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ë–î
    await repairDatabase();
    return SuccessV2(true);
  }
}

// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫—É
errorHandler.addRecoveryHandler(CustomRecoveryHandler());
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π

```dart
class MyErrorAnalytics implements ErrorAnalyticsV2 {
  @override
  Future<void> trackError(AppErrorV2 error, ErrorAnalyticsData data) async {
    await FirebaseAnalytics.instance.logEvent(
      name: 'error_occurred',
      parameters: {
        'error_category': error.category.name,
        'error_type': error.type,
        'error_severity': error.severity.name,
        'user_id': data.userId,
        'session_id': data.sessionId,
        ...error.analyticsData,
      },
    );
  }
  
  @override
  Future<void> trackRecovery(AppErrorV2 error, bool successful) async {
    await FirebaseAnalytics.instance.logEvent(
      name: 'error_recovery',
      parameters: {
        'error_id': error.id,
        'successful': successful,
      },
    );
  }
  
  @override
  Future<void> trackRetry(AppErrorV2 error, int attemptNumber) async {
    await FirebaseAnalytics.instance.logEvent(
      name: 'error_retry',
      parameters: {
        'error_id': error.id,
        'attempt': attemptNumber,
      },
    );
  }
}
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

```dart
class MyErrorLogger implements ErrorLoggerV2 {
  @override
  Future<void> logError(AppErrorV2 error) async {
    final logEntry = {
      'timestamp': error.timestamp.toIso8601String(),
      'level': error.severity.name,
      'category': error.category.name,
      'type': error.type,
      'message': error.message,
      'technical_details': error.technicalDetails,
      'context': error.context,
      'error_id': error.id,
    };
    
    // –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ —É–¥–∞–ª–µ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
    await sendToLoggingService(logEntry);
    
    // –õ–æ–∫–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
    if (error.severity.isCritical) {
      await saveToLocalLog(logEntry);
    }
  }
  
  @override
  Future<void> logInfo(String message, {Map<String, Object?>? context}) async {
    await sendToLoggingService({
      'level': 'info',
      'message': message,
      'context': context,
      'timestamp': DateTime.now().toIso8601String(),
    });
  }
  
  @override
  Future<void> logWarning(String message, {Map<String, Object?>? context}) async {
    await sendToLoggingService({
      'level': 'warning', 
      'message': message,
      'context': context,
      'timestamp': DateTime.now().toIso8601String(),
    });
  }
}
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏

```dart
// –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –æ—à–∏–±–æ–∫
final stats = errorHandler.getErrorStats();
print('–í—Å–µ–≥–æ –æ—à–∏–±–æ–∫: ${stats['totalErrorsTracked']}');
print('–ê–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫: ${stats['activeRetryAttempts']}');

// –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö
errorHandler.clearRetryData(olderThan: const Duration(hours: 24));

// –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –ø–æ—Ç–æ–∫ –æ—à–∏–±–æ–∫
errorHandler.errorStream.listen((error) {
  print('–ù–æ–≤–∞—è –æ—à–∏–±–∫–∞: ${error.id}');
  
  // –û—Ç–ø—Ä–∞–≤–∫–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
  if (error.severity.isCritical) {
    sendToMonitoring(error);
  }
});
```

## üì± –ü—Ä–∏–º–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### –í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

```dart
class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: 'CodexaPass',
      scaffoldMessengerKey: ErrorDisplayV2.scaffoldKey,
      home: MyHomePage(),
      builder: (context, child) {
        // –ì–ª–æ–±–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ UI
        return ErrorBoundary(
          child: child,
          onError: (error, stackTrace) async {
            final appError = mapToAppError(error, stackTrace);
            await getGlobalErrorHandler().handleError(appError);
          },
        );
      },
    );
  }
}
```

### –í —Å–µ—Ä–≤–∏—Å–∞—Ö

```dart
class UserService {
  final ErrorHandlerV2 _errorHandler = getGlobalErrorHandler();
  
  Future<ResultV2<User>> getCurrentUser() async {
    return await _errorHandler.executeWithRetry(() async {
      final response = await http.get('/api/user/current');
      
      if (response.statusCode != 200) {
        throw NetworkErrorV2(
          errorType: NetworkErrorType.serverError,
          message: '–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è',
          statusCode: response.statusCode,
          url: '/api/user/current',
        );
      }
      
      return User.fromJson(response.data);
    }, maxRetries: 2);
  }
  
  Future<ResultV2<void>> updateUser(User user) async {
    return await _errorHandler.executeWithErrorHandling(() async {
      // –í–∞–ª–∏–¥–∞—Ü–∏—è
      final validationResult = validateUser(user);
      if (validationResult.isFailure) {
        throw validationResult.error!;
      }
      
      // –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
      await http.put('/api/user/${user.id}', data: user.toJson());
    });
  }
}
```

## üé® –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Ç–∏–ø—ã –æ—à–∏–±–æ–∫ –≤–º–µ—Å—Ç–æ –æ–±—â–∏—Ö
- –î–æ–±–∞–≤–ª—è–π—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏

### 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–π—Ç–µ `Result<T>` –≤–º–µ—Å—Ç–æ try-catch —Ç–∞–º, –≥–¥–µ —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫
- –õ–æ–≥–∏—Ä—É–π—Ç–µ –≤—Å–µ –æ—à–∏–±–∫–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

### 3. UI –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- –ü–æ–∫–∞–∑—ã–≤–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–π—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é
- –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–π—Ç–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ –æ–±—ã—á–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

### 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ —Ç—Ä–µ–Ω–¥—ã –æ—à–∏–±–æ–∫
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–ª–µ—Ä—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
- –†–µ–≥—É–ª—è—Ä–Ω–æ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –ª–æ–≥–∏

## üìä –ú–∏–≥—Ä–∞—Ü–∏—è —Å v1

–û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏:

```dart
// v1
try {
  final data = await fetchData();
} catch (e) {
  final error = AppError.network(
    type: NetworkErrorType.timeout,
    message: 'Timeout',
  );
  errorHandler.handleError(error);
}

// v2
final result = await getGlobalErrorHandler().executeWithRetry(() async {
  return await fetchData();
});

result.fold(
  (data) => processData(data),
  (error) => showError(error),
);
```

## üö¶ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –æ—à–∏–±–æ–∫ v2 –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–æ—â–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è:
- **–¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ–π** —Ä–∞–±–æ—Ç—ã —Å –æ—à–∏–±–∫–∞–º–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è** –ø–æ—Å–ª–µ —Å–±–æ–µ–≤
- **–ì–∏–±–∫–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è** –æ—à–∏–±–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- **–î–µ—Ç–∞–ª—å–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞** –∏ –∞–Ω–∞–ª–∏–∑–∞
- **–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏** —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç—É —Å–∏—Å—Ç–µ–º—É –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–∞–¥–µ–∂–Ω—ã—Ö –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏ –¥—Ä—É–∂–µ–ª—é–±–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.
